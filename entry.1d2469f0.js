import{d as b,u as z,c as V,o as s,a as d,b as i,t as F,w as L,v as O,m as D,e as R,F as w,r as M,f as C,g as y,h as E,i as p,n as N,j as U,k as P,l as I,S as B}from"./chunks/chunk.a6ad9e27.js";function j(){return Math.floor(Math.random()*16777215).toString(16)}var h=(t,a)=>{const o=t.__vccOpts||t;for(const[e,l]of a)o[e]=l;return o};const A=b({props:{type:{default:"text"},label:null,value:null,error:{default:""},id:{default:j()}},emits:["update:value","update:error","blur","input"],setup(t,{expose:a,emit:o}){a();const e=t,l=z(),n=V({get:()=>e.value,set:u=>{o("update:value",u),o("update:error","")}}),r={props:e,attrs:l,emit:o,fieldValue:n};return Object.defineProperty(r,"__isScriptSetup",{enumerable:!1,value:!0}),r}}),T=["for"],q=["id","placeholder"],W=["id","type","placeholder"],J=["data-validates","value"];function G(t,a,o,e,l,n){return s(),d(w,null,[i("label",{for:o.id,class:"form-control-label visually-hidden"},F(o.label),9,T),o.type=="textarea"?L((s(),d("textarea",D({key:0,"onUpdate:modelValue":a[0]||(a[0]=r=>e.fieldValue=r)},e.attrs,{id:e.props.id,placeholder:o.label,class:[{"is-invalid":o.error.length>0},"form-control"],onBlur:a[1]||(a[1]=r=>e.emit("blur",r)),onInput:a[2]||(a[2]=r=>e.emit("input",r))}),null,16,q)),[[O,e.fieldValue,void 0,{trim:!0}]]):L((s(),d("input",D({key:1,"onUpdate:modelValue":a[3]||(a[3]=r=>e.fieldValue=r)},e.attrs,{id:e.props.id,type:o.type=="email"?"text":o.type,placeholder:o.label,class:[{"is-invalid":o.error.length>0},"form-control"],autocomplete:"off",onBlur:a[4]||(a[4]=r=>e.emit("blur",r)),onInput:a[5]||(a[5]=r=>e.emit("input",r))}),null,16,W)),[[R,e.fieldValue,void 0,{trim:!0}]]),i("input",{"data-validates":`#${e.props.id}`,readonly:"",disabled:"",tabindex:"-1",class:"invalid-feedback form-control-plaintext p-0 mx-0 mt-0",value:o.error},null,8,J)],64)}var H=h(A,[["render",G]]);const K=b({props:{message:null},setup(t,{expose:a}){a();const e={props:t};return Object.defineProperty(e,"__isScriptSetup",{enumerable:!1,value:!0}),e}}),Q={class:"p-5 alert alert-warning text-center error-state"},X=i("h1",{class:"mx-auto mb-3"},"Error",-1),Y={key:0},Z={key:1};function $(t,a,o,e,l,n){return s(),d("div",Q,[X,o.message?(s(),d("span",Y,F(e.props.message),1)):(s(),d("span",Z,"Something went wrong on our end. Please try again later."))])}var k=h(K,[["render",$]]);function ee(t){async function a(){const e=await fetch(`${t}/contact/config`);if(!e.ok)throw Error(`Server responded with ${e.status}: ${e.statusText}`);const l=await e.json(),{nameMaxLength:n,organizationMaxLength:r,emailMaxLength:u,emailRegex:f,messageMinLength:c,messageMaxLength:S}=l,v={nameMaxLength:n,organizationMaxLength:r,emailMaxLength:u,emailRegex:f,messageMinLength:c,messageMaxLength:S},_=Object.keys(v).filter(x=>v[x]===void 0);if(_.length)throw Error(`API sent invalid config to contact form. Undefined props: ${_.join()}`);return v}async function o(e){const l={};for(const r in e)l[r]=e[r].value;const n=await fetch(`${t}/contact/`,{method:"POST",mode:"cors",headers:{"Access-Control-Allow-Origin":t},credentials:"same-origin",body:JSON.stringify(l)});if(n.ok)return!0;if(n.status===422){const r=await n.json();for(const u in r)e[u].error=r[u][0];return!1}throw Error(`Server responded with ${n.status}: ${n.statusText}`)}return{getFormConfig:a,postFormData:o}}const g={required:t=>`${t} is required.`,tooLong:(t,a)=>`${t} can't be longer than ${a} characters.`,tooShort:(t,a)=>`${t} must be at least ${a} characters long.`,badEmail:()=>"Please enter a valid email address."};function ae(t){function a(n){return n.name.value.length===0?(n.name.error=g.required("Name"),!1):n.name.value.length>t.nameMaxLength?(n.name.error=g.tooLong("Name",t.nameMaxLength),!1):!0}function o(n){return n.organization.value.length>t.organizationMaxLength?(n.organization.error=g.tooLong("Organization name",t.organizationMaxLength),!1):!0}function e(n){const r=new RegExp(t.emailRegex);return n.email.value.length===0?(n.email.error=g.required("Email address"),!1):n.email.value.length>t.emailMaxLength?(n.email.error=g.tooLong("Email address",t.emailMaxLength),!1):r.test(n.email.value)?!0:(n.email.error=g.badEmail(),!1)}function l(n){return n.message.value.length<t.messageMinLength?(n.message.error=g.tooShort("Message content",t.messageMinLength),!1):n.message.value.length>t.messageMaxLength?(n.message.error=g.tooLong("Message content",t.messageMaxLength),!1):!0}return{validateName:a,validateOrganization:o,validateEmail:e,validateMessage:l}}var m=(t=>(t[t.Loading=0]="Loading",t[t.Ready=1]="Ready",t[t.FatalError=2]="FatalError",t[t.Sending=3]="Sending",t[t.Success=4]="Success",t))(m||{});function te(t){const a=t.target;let o=a.value.replace(/\s/g," ").replace(/\s\s+/g," ").replace(/^\s+/g,"");a.value=o}function re(t){const a=t.target;let o=a.value.replace(/\s/g," ").replace(/\s\s+/g," ").replace(/^\s+/g,"");a.value=o}function ne(t){const a=t.target;let o=a.value.replace(/\s/g,"");a.value=o}const oe={},le={class:"p-5 alert alert-success text-center"},ie=i("h1",{class:"mx-auto mb-3"},"Message Sent",-1),se=i("span",null,"I'll reply to you via email as soon as I can.",-1),de=i("br",null,null,-1),ue=i("span",null,"Thanks for stopping by!",-1),me=[ie,se,de,ue];function ce(t,a){return s(),d("div",le,me)}var ge=h(oe,[["render",ce]]);const fe=b({props:{apiRootUrl:null,debugConfig:null},async setup(t,{expose:a}){a();let o,e;const l=t,n=M(m.Loading),r=ee(l.apiRootUrl),u=l.debugConfig??([o,e]=C(()=>r.getFormConfig()),o=await o,e(),o),f=ae(u),c=M({name:{value:"",error:""},organization:{value:"",error:""},email:{value:"",error:""},message:{value:"",error:""}});n.value=m.Ready;async function S(){n.value=m.Sending;let _=[f.validateName(c.value),f.validateOrganization(c.value),f.validateEmail(c.value),f.validateMessage(c.value)].every(x=>x);if(!_){n.value=m.Ready;return}try{_=await r.postFormData(c.value)}catch(x){n.value=m.FatalError,console.error(x);return}if(!_){n.value=m.Ready;return}n.value=m.Success}const v={props:l,formState:n,formAPI:r,formConfig:u,formValidators:f,formData:c,submitForm:S,FormInput:H,ErrorState:k,FormState:m,cleanNameFieldInput:te,cleanOrganizationFieldInput:re,cleanEmailFieldInput:ne,SuccessState:ge};return Object.defineProperty(v,"__isScriptSetup",{enumerable:!1,value:!0}),v}}),ve=["disabled"],_e={class:"row g-2"},pe={class:"col-12"},he={class:"col-12"},xe={class:"col-12"},ye={class:"col-12"},be={class:"col-12"},Se={key:0,class:"spinner-border spinner-border-sm",role:"status"};function Me(t,a,o,e,l,n){return s(),d(w,null,[e.formState===e.FormState.Success?(s(),y(e.SuccessState,{key:0})):E("",!0),e.formState===e.FormState.FatalError?(s(),y(e.ErrorState,{key:1})):(s(),d("fieldset",{key:2,disabled:e.formState!==e.FormState.Ready},[i("div",_e,[i("div",pe,[p(e.FormInput,{type:"text",value:e.formData.name.value,"onUpdate:value":a[0]||(a[0]=r=>e.formData.name.value=r),error:e.formData.name.error,"onUpdate:error":a[1]||(a[1]=r=>e.formData.name.error=r),id:"contact-form__name",label:"Name",maxlength:e.formConfig.nameMaxLength,onBlur:a[2]||(a[2]=r=>e.formValidators.validateName(e.formData)),onInput:e.cleanNameFieldInput},null,8,["value","error","maxlength","onInput"])]),i("div",he,[p(e.FormInput,{label:"Organization (optional)",type:"text",id:"contact-form__organization",value:e.formData.organization.value,"onUpdate:value":a[3]||(a[3]=r=>e.formData.organization.value=r),error:e.formData.organization.error,"onUpdate:error":a[4]||(a[4]=r=>e.formData.organization.error=r),maxlength:e.formConfig.organizationMaxLength,onBlur:a[5]||(a[5]=r=>e.formValidators.validateOrganization(e.formData)),onInput:e.cleanOrganizationFieldInput},null,8,["value","error","maxlength","onInput"])]),i("div",xe,[p(e.FormInput,{label:"Email",type:"email",id:"contact-form__email",value:e.formData.email.value,"onUpdate:value":a[6]||(a[6]=r=>e.formData.email.value=r),error:e.formData.email.error,"onUpdate:error":a[7]||(a[7]=r=>e.formData.email.error=r),maxlength:e.formConfig.emailMaxLength,onBlur:a[8]||(a[8]=r=>e.formValidators.validateEmail(e.formData)),onInput:e.cleanEmailFieldInput},null,8,["value","error","maxlength","onInput"])]),i("div",ye,[p(e.FormInput,{label:"Message",type:"textarea",id:"contact-form__message",value:e.formData.message.value,"onUpdate:value":a[9]||(a[9]=r=>e.formData.message.value=r),error:e.formData.message.error,"onUpdate:error":a[10]||(a[10]=r=>e.formData.message.error=r),minlength:e.formConfig.messageMinLength,maxlength:e.formConfig.messageMaxLength,rows:4,onBlur:a[11]||(a[11]=r=>e.formValidators.validateMessage(e.formData))},null,8,["value","error","minlength","maxlength"])]),i("div",be,[i("button",{onClick:a[12]||(a[12]=r=>e.submitForm()),id:"contact-form__submit",class:N([e.formState===e.FormState.Ready?"btn-primary":"btn-secondary","btn btn-lg w-100 mt-1"])},[e.formState!==e.FormState.Ready?(s(),d("div",Se)):E("",!0),U(" "+F(e.formState===e.FormState.Ready?"Submit":"Submitting..."),1)],2)])])],8,ve))],64)}var Ee=h(fe,[["render",Me]]);const Fe={},Le={class:"p-5 alert alert-primary text-center loading-state"},De=i("h1",{class:"mx-auto mb-3"},"Loading...",-1),Ie=[De];function we(t,a){return s(),d("div",Le,Ie)}var ke=h(Fe,[["render",we]]);const ze=b({props:{apiRootUrl:null},setup(t,{expose:a}){a();const o=t,e=M(!1);P(n=>(e.value=!0,console.error(n),!1));const l={props:o,formEncounteredFatalError:e,ContactForm:Ee,ErrorState:k,LoadingState:ke};return Object.defineProperty(l,"__isScriptSetup",{enumerable:!1,value:!0}),l}}),Ve={id:"contact-form"};function Oe(t,a,o,e,l,n){return s(),d("div",Ve,[e.formEncounteredFatalError?(s(),y(e.ErrorState,{key:0,message:"The server could not be reached at this time."})):E("",!0),(s(),y(B,null,{fallback:I(()=>[i("div",null,[p(e.LoadingState)])]),default:I(()=>[p(e.ContactForm,{"api-root-url":e.props.apiRootUrl},null,8,["api-root-url"])]),_:1}))])}var Ce=h(ze,[["render",Oe]]);export{Ce as default};
